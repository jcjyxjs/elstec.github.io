---
layout: post
title: 使用LiteSpeed为网站启用HTTP/3
slug: enhttp3
date: 2020-02-12 21:50
status: publish
author: jcjyxjs
categories:
  - 网络
tags:
  - HTTP
  - HTTP/3
  - HTTP/2
  - 建站
  - 网络
  - QUIC
  - UDP
excerpt: HTTP/3
---

# 我想说的
关于HTTP/3我就不介绍了，网上有，多说无益。真的。
就目前浏览器支持情况真的也就一般。

![](https://cdn.elstec.cn/13/0.png)

# 实现
目前支持HTTP/3的只有LiteSpeed和Caddy，Nginx暂时还不支持，已知可行方法都需要通过Doker，也就是Nginx+Caddy实现，或者通过CloudFlare的开源项目实现，稳定性肯定不如前者。

# 过程
**本次需要在服务器安全组或防火墙放通** `TCP:7080` **和** `UDP:443`

我这次采用的是LiteSpeed的开源项目OpenLiteSpeed。

OpenLiteSpeed有多种安装方式，我就采用第4种也就是命令行一键安装。
![](https://cdn.elstec.cn/13/3.png)
根据官方说法，OpenLiteSpeed仅支持具有64位平台的Centos（6-7），Debian（7-9）和Ubuntu（14,16,18）。
```
wget --no-check-certificate https://raw.githubusercontent.com/litespeedtech/ols1clk/master/ols1clk.sh && bash ols1clk.sh
```
如果需要安装WordPress,就在命令后面加` -w`。运行的时候会告诉你后台密码，后台邮件，PHP版本，数据库版本以及两个端口。

![](https://cdn.elstec.cn/13/4.png)

安装完成之后，会把后台账号密码存储在`/usr/local/lsws/password`。
这时可以用https://ip:7080访问后台。

首先需要在ssh中，cd到`/usr/local/lsws/`该目录下，然后新建一个文件夹，名字随便。比方我叫`http3test`


```
mkdir http3test
mkdir http3test/{conf,html,logs}
```

访问web后台 *（后台可以改简体中文）* 点击虚拟主机，再点击➕号进行新建虚拟主机。
虚拟主机名使用域名就行，虚拟主机根目录就是刚刚创建的文件夹名称，配置文件就这么填`$SERVER_ROOT/conf/vhosts/http3test.elstec.cn/vhconf.conf`要把文件夹名称改成自己的。先填写完整之后点击保存，会提示没有配置文件，点击旁边的`CLICK TO CREATE`进行创建，再次保存就可以了。*（启用脚本/外部应用程序和访问管制随你一般没什么用就选否。）*

![](https://cdn.elstec.cn/13/5.png)

新建虚拟机之后先不要平滑重启。点击查看进入虚拟机设置，查看就是一个放大镜图标。点击SSL选项，找到安全，点击修改，把`Enable QUIC`改为是，并保存。

![](https://cdn.elstec.cn/13/6.png)

找到监听器，就是虚拟主机选项上面那个。默认有80和443，443点击查看。找到SSL，找到SSL私钥和证书，点击编辑，填入你的证书地址，然后保存。再次找到安全和特性选项，把`Allow QUIC`改是就行。
退回到443的常规，最下方有一个虚拟主机映射，新建映射，把虚拟主机和域名进行绑定，保存即可。

![](https://cdn.elstec.cn/13/7.png)
然后进行平滑重启。页面索引什么的我就不说了没意思。
最后就是测试结果+HTTP/3 CHECK的结果。
![](https://cdn.elstec.cn/13/1.png)

![](https://cdn.elstec.cn/13/2.png)

需要浏览器支持的话，Chrome打开`chrome://flags/`，找到`Experimental QUIC protocol`选择Enabled。新版Edge也可以直接复制打开，页面会自动跳转到`edge://flags/`步骤同上就行。

# 最后
我想说，我评论区的评论通知有时候会鬼畜发不出去我也没办法，到时候再说:P